<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>SphereMark - Panoramic Image Labeling</title>
        <link rel="stylesheet" href="/styles/main.css" />
    </head>
    <body>
        <div id="canvas-container"></div>

        <div id="image-browser">
            <div class="browser-header">
                <h1>SphereMark</h1>
                <p>Select a panoramic image to label</p>
                <div class="browser-actions">
                    <button id="scan-button" class="btn btn-primary">
                        <span>üîÑ</span> Scan for Images
                    </button>
                </div>
            </div>

            <div id="image-grid"></div>

            <div id="loading-state" class="hidden">
                <p>Loading images...</p>
            </div>

            <div id="scanning-state" class="hidden">
                <p>Scanning for images...</p>
            </div>

            <div id="error-state" class="hidden">
                <p>Failed to load images</p>
                <button id="retry-button" class="btn btn-primary">Retry</button>
            </div>
        </div>

        <!-- Toolbar -->
        <div id="toolbar" class="hidden">
            <button
                id="mode-view"
                class="mode-button active"
                title="View Mode (ESC)"
            >
                <span>üëÅÔ∏è</span>
            </button>
            <button id="mode-draw" class="mode-button" title="Draw Mode (D)">
                <span>‚úèÔ∏è</span>
            </button>
            <button id="mode-edit" class="mode-button" title="Edit Mode (E)">
                <span>‚úã</span>
            </button>

            <div class="toolbar-divider"></div>

            <button id="back-to-browser" class="icon-button" title="Back to Image Browser">
                <span>‚¨ÖÔ∏è</span>
            </button>

            <button id="toggle-panel" class="icon-button" title="Toggle Panel">
                <span>üìã</span>
            </button>

            <button id="export-boxes" class="icon-button" title="Export Boxes">
                <span>üíæ</span>
            </button>
        </div>

        <!-- Side Panel -->
        <div id="side-panel" class="hidden">
            <div class="panel-header">
                <h2>Bounding Boxes</h2>
                <button id="close-panel" class="icon-button">&times;</button>
            </div>

            <div class="panel-content">
                <div id="box-list"></div>
                <div id="empty-state">
                    <p>No bounding boxes yet</p>
                    <p style="font-size: 0.9em; margin-top: 0.5rem">
                        Switch to Draw mode to create one
                    </p>
                </div>
            </div>
        </div>

        <!-- Mode Indicator -->
        <div id="mode-indicator" class="hidden">
            <span id="mode-text">View Mode</span>
            <span id="mode-hint">Use OrbitControls to explore</span>
        </div>

        <!-- Save Status Indicator -->
        <div id="save-status" class="hidden">
            <span id="save-text">Saved</span>
        </div>

        <!-- Label suggestions datalist -->
        <datalist id="label-suggestions">
            <option value="traffic_sign">
            <option value="person">
            <option value="vehicle">
            <option value="building">
            <option value="tree">
            <option value="street_light">
            <option value="sign">
            <option value="car">
            <option value="bicycle">
            <option value="motorcycle">
        </datalist>

        <!-- Export Dialog -->
        <div id="export-dialog" class="dialog hidden">
            <div class="dialog-overlay"></div>
            <div class="dialog-content">
                <div class="dialog-header">
                    <h2>Export Annotations</h2>
                    <button class="dialog-close">&times;</button>
                </div>
                <div class="dialog-body">
                    <div class="export-options">
                        <div class="form-group">
                            <label>Export Format</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="format" value="coco" checked>
                                    <span>COCO Format (JSON)</span>
                                    <p class="radio-description">Standard COCO format with spherical coordinates</p>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="format" value="yolo">
                                    <span>YOLO Format (TXT)</span>
                                    <p class="radio-description">YOLO format with spherical coordinates, one .txt file per image</p>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Scope</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="scope" value="current" checked>
                                    <span>Current Image Only</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="scope" value="all">
                                    <span>All Images</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Preview</label>
                            <div class="export-preview">
                                <pre id="export-preview-content">Select options to see preview...</pre>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dialog-footer">
                    <button id="export-cancel" class="btn btn-secondary">Cancel</button>
                    <button id="export-download" class="btn btn-primary">Download</button>
                    <button id="export-copy" class="btn btn-secondary">Copy to Clipboard</button>
                </div>
            </div>
        </div>

        <script type="module" src="/src/main.js"></script>
    </body>
</html>
